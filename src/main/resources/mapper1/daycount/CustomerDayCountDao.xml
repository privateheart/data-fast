<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="io.renren.modules1.daycount.dao.CustomerDayCountDao" >

   <select id="queryDayCountList" resultType="io.renren.modules1.daycount.entity.DayCount">
       SELECT td.date AS count_date,SUM(IFNULL(cdc.flow_count, 0)) AS flow_count
       FROM tmpdate td LEFT JOIN customer_${customerId}_day_count cdc ON td.date=cdc.count_date
       WHERE 1=1
       <if test="startDate != null and startDate != ''">
           <![CDATA[ and DATE_FORMAT(td.date,'%Y-%m-%d')>=#{startDate} ]]>
       </if>
       <if test="endDate != null and endDate != ''">
           <![CDATA[ and DATE_FORMAT(td.date,'%Y-%m-%d')<=#{endDate} ]]>
       </if>
       GROUP BY td.date
       ORDER BY td.date
   </select>

</mapper>